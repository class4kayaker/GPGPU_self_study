<h3 id="mathematical-notes">Mathematical Notes</h3>
<p>The appropriate derivative form for this problem will be</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>∂</mi><mi>T</mi></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac><mo>−</mo><mi>∇</mi><mo stretchy="false" form="prefix">(</mo><mi>k</mi><mi>∇</mi><mi>T</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">\frac{\partial T}{\partial t} -\nabla (k\nabla T) =f</annotation></semantics></math></p>
<p>As an initial case, we will focus on the case where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math> is static, so</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>∇</mi><mo stretchy="false" form="prefix">(</mo><mi>k</mi><mi>∇</mi><mi>T</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">-\nabla (k\nabla T) =f</annotation></semantics></math></p>
<p>To discretize, consider the test function set <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\phi_i</annotation></semantics></math> and let <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>h</mi></msub><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>T</mi><mi>i</mi></msub><msub><mi>ϕ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_h=\sum\limits_i T_i\phi_i</annotation></semantics></math>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>∇</mi><mo stretchy="false" form="prefix">(</mo><mi>k</mi><mi>∇</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mi>i</mi></msub><msub><mi>ϕ</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo>=</mo><mi>f</mi><msub><mi>ϕ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">-\nabla (k\nabla (T_i\phi_i))\phi_j=f\phi_j</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>∫</mo><mi>Ω</mi></munder><mo>−</mo><mi>∇</mi><mo stretchy="false" form="prefix">(</mo><mi>k</mi><mi>∇</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mi>i</mi></msub><msub><mi>ϕ</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mi>d</mi><mover><mi>x</mi><mo accent="true">⃗</mo></mover><mo>=</mo><munder><mo>∫</mo><mi>Ω</mi></munder><mi>f</mi><msub><mi>ϕ</mi><mi>j</mi></msub><mi>d</mi><mover><mi>x</mi><mo accent="true">⃗</mo></mover></mrow><annotation encoding="application/x-tex">\int\limits_\Omega-\nabla (k\nabla (T_i\phi_i))\phi_jd\vec{x}=\int\limits_\Omega f\phi_j d\vec{x}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>∫</mo><mi>Ω</mi></munder><mo stretchy="false" form="prefix">(</mo><mi>k</mi><mi>∇</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mi>i</mi></msub><msub><mi>ϕ</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mi>∇</mi><msub><mi>ϕ</mi><mi>j</mi></msub><mi>d</mi><mover><mi>x</mi><mo accent="true">⃗</mo></mover><mo>−</mo><munder><mo>∫</mo><mrow><mi>∂</mi><mi>Ω</mi></mrow></munder><mo stretchy="false" form="prefix">(</mo><mi>k</mi><mi>∇</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mi>i</mi></msub><msub><mi>ϕ</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>⋅</mo><mover><mi>n</mi><mo accent="true">⃗</mo></mover><mo stretchy="false" form="postfix">]</mo><mi>p</mi><mi>h</mi><msub><mi>i</mi><mi>j</mi></msub><mi>d</mi><mover><mi>x</mi><mo accent="true">⃗</mo></mover><mo>=</mo><munder><mo>∫</mo><mi>Ω</mi></munder><mi>f</mi><msub><mi>ϕ</mi><mi>j</mi></msub><mi>d</mi><mover><mi>x</mi><mo accent="true">⃗</mo></mover></mrow><annotation encoding="application/x-tex">\int\limits_\Omega(k\nabla (T_i\phi_i))\nabla\phi_j d\vec{x}-\int\limits_{\partial \Omega}(k\nabla (T_i\phi_i)\cdot\vec{n}]phi_jd\vec{x}=\int\limits_\Omega f\phi_j d\vec{x}</annotation></semantics></math></p>
